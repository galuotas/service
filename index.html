<!DOCTYPE html>
<html lang="lt">
<head>
  <meta charset="UTF-8">
  <title>Barkodo ir skaiÄiÅ³ nuskaitymas</title>
  <script src="https://unpkg.com/@zxing/library@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 600px; margin: auto; }
    input, button { margin: 10px 0; display: block; }
    .result { margin-top: 10px; padding: 10px; background: #f0f0f0; }
    hr { margin: 30px 0; }
  </style>
</head>
<body>
  <h2>ğŸ“· Barkodo nuskaitymas</h2>
  <input type="file" id="barcodeInput" accept="image/*" />
  <button onclick="scanBarcode()">Nuskaityti barkodÄ…</button>
  <div class="result" id="barcodeResult">ÄŒia bus barkodo rezultatas</div>

  <hr>

  <h2>ğŸ”¢ SkaiÄiÅ³ nuskaitymas</h2>
  <input type="file" id="numberInput" accept="image/*" />
  <button onclick="scanNumbers()">Nuskaityti skaiÄius</button>
  <div class="result" id="numberResult">ÄŒia bus nuskaityti skaiÄiai</div>

  <!-- 
  âœ… Kodo komentarai: kas buvo padaryta
  - Ä®keltos bibliotekos ZXing (barkodams) ir Tesseract.js (tekstui/skaiÄiams)
  - PridÄ—ta vartotojo sÄ…saja su Ä¯kÄ—limo laukeliais ir mygtukais
  - BarkodÅ³ nuskaitymui naudojamas ZXing su decodeFromImageUrl
  - SkaiÄiÅ³ nuskaitymui naudojamas Tesseract su whitelist '0123456789' ir PSM reÅ¾imu 7
  - Rezultatai rodomi tik paspaudus mygtukÄ…
  - Jei neveiks ateityje: patikrink CDN nuorodas, narÅ¡yklÄ—s klaidas (F12 â†’ Console), failÅ³ pavadinimus
  -->

  <script>
    // Barkodo nuskaitymas
    let barcodeImageUrl = null;
    document.getElementById('barcodeInput').addEventListener('change', (e) => {
      barcodeImageUrl = URL.createObjectURL(e.target.files[0]);
    });

    function scanBarcode() {
      if (!barcodeImageUrl) {
        alert('Ä®kelkite paveikslÄ—lÄ¯ su barkodu.');
        return;
      }
      const codeReader = new ZXing.BrowserBarcodeReader();
      codeReader.decodeFromImageUrl(barcodeImageUrl).then(result => {
        document.getElementById('barcodeResult').innerText = 'Barkodas: ' + result.text;
      }).catch(err => {
        document.getElementById('barcodeResult').innerText = 'Nepavyko nuskaityti barkodo.';
        console.error(err);
      });
    }

    // SkaiÄiÅ³ nuskaitymas
    let numberImageUrl = null;
    document.getElementById('numberInput').addEventListener('change', (e) => {
      numberImageUrl = URL.createObjectURL(e.target.files[0]);
    });

    function scanNumbers() {
      if (!numberImageUrl) {
        alert('Ä®kelkite paveikslÄ—lÄ¯ su skaiÄiais.');
        return;
      }

      Tesseract.recognize(numberImageUrl, 'eng', {
        logger: m => console.log(m),
        tessedit_char_whitelist: '0123456789',
        tessedit_pageseg_mode: 7
      }).then(result => {
        document.getElementById('numberResult').innerText = 'SkaiÄiai: ' + result.data.text.trim();
      }).catch(err => {
        document.getElementById('numberResult').innerText = 'Nepavyko nuskaityti skaiÄiÅ³.';
        console.error(err);
      });
    }
  </script>
</body>
</html>
